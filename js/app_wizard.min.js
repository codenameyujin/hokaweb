for (var filterTags = questions.FILTERS, filterTagsArr = {}, i = 0, len = filterTags.length; i < len; i++) filterTagsArr[filterTags[i].filter] = [];
var mix = {
        methods: {
            bar: function() {},
            take: function(t, e) {
                for (var s in t) this.contains(e, s) || delete t[s];
                return t
            },
            contains: function(t, e) {
                for (var s = -1, a = t.length; ++s < a;)
                    if (t[s] === e) return !0;
                return !1
            },
            prefix: function(t, e) {
                for (var s = -1, a = t.length, r = []; ++s < a;) r.push(e + t[s]);
                return r
            }
        }
    },
    mixFilter = {
        data: filterTagsArr
    },
    app = new Vue({
        el: appInit.id,
        mixins: [mix, mixFilter],
        components: {
            "product-block": {
                props: ["p", "index", "hashIcons", "type"],
                template: "#productBlock",
                data: function() {
                    return {
                        isActive: !1
                    }
                },
                created() {},
                mounted: function() {
                    this.$parent.introCookies || "better" != this._props.type || document.getElementsByClassName("user_hints")[0].classList.add("show"), this.$parent.goTop()
                },
                methods: {
                    hints: function(t, e) {
                        switch (e) {
                            case 1:
                                document.getElementsByClassName("user_hints")[0].classList.remove("show"), document.getElementsByClassName("user_hints")[1].classList.add("show");
                                break;
                            case 2:
                                var s = this.$parent;
                                s.introCookies || (s.introCookies = !0, s.$cookies.set(appInit.cookiesKey, !0, "30d", null, null, !0, "Lax")), document.getElementsByClassName("user_hints")[1].classList.remove("show")
                        }
                    },
                    toggleClass: function(t) {
                        this.isActive = !this.isActive
                    },
                    enter: function() {},
                    leave: function() {},
                    afterEnter: function() {},
                    afterLeave: function() {},
                    handHashTags(t) {
                        var e = _.find(this.$parent.hashTagtext, {
                            keys: t
                        });
                        if (e) return e.title
                    }
                }
            }
        },
        data: {
            ver: "",
            loading: !1,
            gotop: !0,
            isActive: !1,
            products: [],
            filters: [],
            responses: [],
            FILTERS: questions.FILTERS,
            FILTERSTAGS: filterTagsArr,
            FILTERSPRICE: questions.filter_price,
            FILTERSTAGSNO: [],
            FILTERSTAGSNU: 0,
            FILTERS_TAGS: [],
            FILTERS_ITEMS: [],
            Fnext: 1,
            filtersRecommend: [],
            filterItems: null,
            finalFilters: [],
            finalRecommend: [],
            q1: questions.q1,
            q2: questions.q2,
            q3: questions.q3,
            hashTagIcon: questions.hashTagIcon,
            hashTagtext: questions.hashTag,
            inputsStep1: 0,
            inputsStep2: [],
            inputsStep3: [],
            step: 0,
            step1YN: "",
            step1YNint: 0,
            allData: "",
            allProducts: "",
            introCookies: null,
            share2FB: {},
            compareFinal: ""
        },
        created: function() {
            this.introCookies = this.$cookies.isKey(appInit.cookiesKey) ? this.$cookies.get(appInit.cookiesKey) : null, document.getElementById("btn-next").classList.add("hide"), this.FILTERSTAGSNO = this.FILTERS.filter(t => !1 === t.fi).map(t => "f__" + t.filter)
        },
        mounted: function() {
            var t = this;
            this.$nextTick(function() {}), this.mobileFilter("loading-start"), axios({
                method: "get",
                url: appInit.APIs.products,
                timeout: appInit.APIs.timeout,
                responseType: "json"
            }).then(e => {
                t.products = e.data.products, t.version = e.data.version;
                var s = _.map(e.data.products, function(t) {
                    return t.gpn
                });
                t.allData = e.data, t._getProducts(s).then(() => {
                    t.removeClass("btn-next"), t.products.map(t => t.gpn);
                    let e = t.reduxArr(t.allProducts, ["gpn", "currencyFormat", "price", "pricePromotion", "link", "icon_url"]),
                        s = _.merge(t.products, e).map(t => ({
                            ...t,
                            isActive: !1
                        }));
                    s.map(function(e, s, a) {
                        var r = t.findLevel(e.price);
                        return e.tags.push(r), e
                    }), t.products = s, t.allProducts = s;
                }), this.goStepShow(0)
            }).catch(t => {}), this.mobileFilter("loading-end")
        },
        methods: {
            reduxArr: (t, e) => t.map(t => e.reduce((e, s) => (e[s] = t[s], e), {})),
            findLevel(t) {
                for (let {
                        min: e,
                        max: s,
                        keys: a,
                        filter: r
                    } of this.FILTERSPRICE)
                    if (t >= e && t <= s) return `f__${r}__${a}`;
                throw Error(`${t} is out of range`)
            },
            toggleClass: function(t) {
                this.isActive = !this.isActive
            },
            hints: function(t, e) {
                switch (e) {
                    case 0:
                        document.getElementsByClassName("user_hints")[0].classList.remove("show"), document.getElementsByClassName("user_hints")[1].classList.add("show");
                        break;
                    case 1:
                        var s = this.$parent;
                        s.introCookies || (s.introCookies = !0, s.$cookies.set(appInit.cookiesKey, !0, "30d", null, null, !0, "Lax")), document.getElementsByClassName("user_hints")[1].classList.remove("show")
                }
            },
            handHashTags(t) {
                var e = _.find(this.hashTagtext, {
                    keys: t
                });
                if (e) return e.title
            },
            removeClass: function(t) {
                document.getElementById(t).classList.remove("hide")
            },
            addClass: function(t) {
                document.getElementById(t).classList.add("show")
            },
            FhasClass: (t, e) => t.classList ? t.classList.contains(e) : !!t.className.match(RegExp("(\\s|^)" + e + "(\\s|$)")),
            FaddClass(t, e) {
                t.classList ? t.classList.add(e) : hasClass(t, e) || (t.className += " " + e)
            },
            FremoveClass(t, e) {
                if (t.classList) t.classList.remove(e);
                else if (hasClass(t, e)) {
                    var s = RegExp("(\\s|^)" + e + "(\\s|$)");
                    t.className = t.className.replace(s, " ")
                }
            },
            reset: function() {
                var t = this;
                Object.getOwnPropertyNames(t.FILTERSTAGS).forEach(function(e) {
                    t.FILTERSTAGS[e] = []
                });
                this.FILTERSTAGSNU = 0, this.FILTERS_TAGS = [], this.FILTERS_ITEMS = [], this.Fnext = 1, document.getElementById("wizard").reset()
            },
            restart: function() {
                this.reset(), this.filters = [], this.filtersRecommend = [], this.filterItems = [], this.finalFilters = [], this.finalRecommend = [], this.inputsStep1 = 0, this.step1YN = "", this.step = 0, this.compareFinal = "", jQuery("#step1 input:radio").removeAttr("checked"), document.getElementsByClassName("find_watch_qa")[0].classList.remove("hide"), document.getElementsByClassName("step_fixed")[0].classList.remove("hide"), document.getElementsByClassName("find_watch_products")[0].classList.remove("show"), document.getElementsByClassName("find_watch_products")[0].classList.add("hide"), document.getElementsByClassName("compare_button")[0].classList.remove("show"), document.getElementsByClassName("compare_button")[0].classList.add("hide"), document.getElementById("btn-next").classList.add("disabled"), this.goStepShow(0)
            },
            mobileFilter: function(t) {
                switch (t) {
                    case "loading-start":
                        document.getElementsByClassName("loading_box")[0].style.cssText = "display: block", document.getElementsByTagName("body")[0].style.cssText = "overflow-y: hidden; height:100%";
                        break;
                    case "loading-end":
                        document.getElementsByClassName("loading_box")[0].style.cssText = "display: none", document.getElementsByTagName("body")[0].style.cssText = "overflow-y: auto; height:auto"
                }
            },
            goTop: function() {
                if (this.gotop) {
                    let t = document.querySelector(".seo_title");
                    t && t.scrollIntoView({
                        behavior: "smooth"
                    })
                }
            },
            goStepShow: function(t) {
                var e = this;
                document.querySelectorAll(".steps").forEach(function(s, a) {
                    a == t ? (s.classList.remove("hide"), document.getElementById("btn-next").classList.add("disabled")) : s.classList.add("hide"), e.step = t, e.step == e.FILTERS.length - 1 ? document.getElementById("btn-next").textContent = appInit.text.step.result : document.getElementById("btn-next").textContent = appInit.text.step.next
                })
            },
            _setStepUrl: function(t) {},
            goStep: function(t) {
                this.step = t;
                var t = t - 1
            },
            prevStep: function(t) {
                let e = this.inputsStep1,
                    s = this.step;
                2 == e ? (this.goStepShow(0), this._setStepUrl(1)) : (this.goStepShow(s - 1), this._setStepUrl(s)), this.goTop()
            },
            nextStep: function(t) {
                this.step1YN = this.inputsStep1, this.inputsStep1;
                let e = this.step,
                    s = 0,
                    a = this.Fnext,
                    r = this.FILTERS[e];
                if (this.FILTERSTAGS[r.filter].length < 1 && !0 === t) return !1;
                if (void 0 !== this.getNested(r, "flow", "tag") && null !== r.flow.tag && void 0 !== this.getNested(r, "flow", "goto") && null !== r.flow.goto && `f__${r.filter}__${r.flow.tag}` == this.FILTERSTAGS[r.filter] && (s = this.FILTERS.findIndex(function(t) {
                        return t.filter == r.flow.goto
                    })), e >= this.FILTERS.length - 1 && this.final(), e < this.FILTERS.length - 1) {
                    if (s > 0) {
                        let n = this.FILTERS[s];
                        if (!1 === n.fi);
                        else {
                            let o = this.filterAI(n),
                                l = o[0];
                            o[1];
                            let c = o[2];
                            this.filterDisplay(l, c)
                        }
                        this.goStepShow(s)
                    } else {
                        let h = this.FILTERS[e + 1];
                        if (!1 === h.fi);
                        else {
                            let d = this.filterAI(h),
                                p = d[0],
                                u = d[1],
                                m = d[2];
                            u.length > 1 ? (this.filterDisplay(p, m), this.goStepShow(e + a)) : (a += 1, this.step += 1, this.nextStep(!1))
                        }
                        this.FILTERSTAGSNU <= 1 && this.goStepShow(this.FILTERS.length - 1)
                    }
                }
            },
            filterDisplay(t, e) {
                var s = this;
                let a = document.querySelector("#wizard"),
                    r = a.querySelectorAll(`ul.f__${e}>li`);
                for (let [n, o] of ([...r].forEach(t => {
                        s.FremoveClass(t, "hide")
                    }), Object.entries(t)))
                    if (o > 0);
                    else {
                        let l = a.querySelectorAll(`ul>li.${n}`);
                        [...l].forEach(t => {
                            !(t.className.indexOf("__all") > -1) && t.classList.add("hide")
                        })
                    }
            },
            filterAI(t) {
                let e = t.filter,
                    s = t.tags,
                    a = this.products.filter(t => this.FILTERS_ITEMS.includes(t.gpn)),
                    r = {};
                s.forEach(function(t) {
                    let e = `f__${t.filter}__${t.tag}`;
                    "all" != t.tag && a.forEach(function(t, s) {
                        t.tags.indexOf(e) > -1 ? r[e] = (r[e] || 0) + 1 : r[e] += 0
                    })
                });
                let n = this.filterObjItems(r);
                return [r, n, e]
            },
            filterObjItems: t => Object.keys(t).filter(function(e) {
                return t[e] > 0
            }),
            getNested: function(t, ...e) {
                return e.reduce((t, e) => t && t[e], t)
            },
            clubArray: (t, e) => t.reduce((t, e, s) => {
                let a = t.findIndex(t => t.obj === e.obj);
                if (-1 !== a) {
                    let r = Object.keys(e)[1];
                    t[a][r] = e[r]
                } else t.push(e);
                return t
            }, []),
            containsAll: function(t, e) {
                for (var s = 0; s < t.length; s++)
                    if (-1 == this._inArray(t[s], e)) return !1;
                return !0
            },
            recommend: function() {},
            final: function() {
                document.getElementsByClassName("find_watch_qa")[0].classList.add("hide"), document.getElementsByClassName("step_fixed")[0].classList.add("hide"), document.getElementsByClassName("find_watch_products")[0].classList.add("show");
                var t = ["gpn"];
                this.filters.length;
                var e = this.filters.map(t => t),
                    s = this.allProducts.filter(function(s) {
                        return t.every(function(t) {
                            return e.includes(s[t])
                        })
                    }),
                    a = _.merge(this.filters, s),
                    r = _.orderBy(a, ["sumRating", "order"], ["desc", "asc"]);
                r.length > 3 && r.splice(3, r.length - 1), r.length > 1 && document.getElementsByClassName("compare_button")[0].classList.remove("hide");
                var n = this.filtersRecommend.map(t => t.gpn),
                    o = this.allProducts.filter(function(e) {
                        return t.every(function(t) {
                            return n.includes(e[t])
                        })
                    }),
                    l = _.merge(this.filtersRecommend, o),
                    c = _.orderBy(l, ["sumRating", "order"], ["desc", "asc"]);
                c.length > 3 && c.splice(3, c.length - 1), this.finalFilters = r, this.finalRecommend = c;
                let h = "",
                    d = "";
                h = this.finalRecommend.map(function(t) {
                    return t.gpn
                }) + "", d = this.FILTERS_TAGS.map(function(t) {
                    return t.replace(RegExp("^f__"), "")
                }) + "", this._ga("find-your-watch", h, d, "Non"), this.share2FB = r.length > 0 ? r[0] : c[0]
            },
            _ga: function(t, e, s, a) {
                window.ga && ga.create && (encodeURIComponent(s + "&" + e), window.dataLayer = window.dataLayer || [], dataLayer.push({
                    event: "Event",
                    category: t,
                    action: e,
                    label: s
                }));
                window.dataLayer.push({
                    "event": t,
                    "quiz_result": e,
                    "quiz_question": s
                })
            },
            onChange(t) {
                var e = this;
                let s = this.step,
                    a = this.FILTERS[s];
                document.getElementById("btn-next").classList.remove("disabled"), this.FILTERSTAGS[a.filter].length < 1 ? document.getElementById("btn-next").classList.add("disabled") : document.getElementById("btn-next").classList.remove("disabled");
                let r = this.FILTERSTAGS,
                    n = "";
                Object.values(r).forEach(t => {
                    Array.isArray(t) && (t = t.filter(function(t) {
                        if (!e.FILTERSTAGSNO.some(e => t.includes(e))) return t
                    })), n += " " + t
                }), n = n.replace(/\,/g, " ").split(" ");
                let o = n.filter(t => null != t && "" != t);
                this.FILTERS_TAGS = o, this.filterTags()
            },
            filterTags: function() {
                var t = this;
                let e = [];
                [...this.FILTERS_TAGS].forEach(t => {
                    -1 === t.indexOf("_all") && e.push(t)
                });
                var s = this.products.filter(({
                    tags: t
                }) => e.every(e => t.includes(e)));
                this.FILTERSTAGSNU = s.length;
                var a = [],
                    r = this.FILTERSTAGS.sports;
                if (r.length > 0) {
                    var a = _.filter(s, function(e) {
                        let s = e.q2.filter(function(t) {
                            return t.rating > 0
                        }).map(function(t) {
                            return `f__sports__${t.title}`
                        });
                        return t.containsAll(r, s)
                    });
                    a.forEach(t => {
                        let e = 0;
                        t.q2.forEach(t => {
                            r.indexOf("f__sports__" + t.title) >= 0 && (e += t.rating)
                        }), t.sumRating = e
                    })
                }
                s = a.length > 0 ? a : s;
                let n = [];
                [...s].forEach(t => {
                    n.push(t.gpn)
                }), this.FILTERS_ITEMS = n, this.filters = n, this.filtersRecommend = n;
                var t = this;
                let o = [];
                [...t.FILTERS_TAGS].forEach(t => {
                    -1 === t.indexOf("_all") && o.push("." + t)
                }), (o + "").replace(/\,/g, "")
            },
            _inArray: function(t, e) {
                for (var s = 0, a = 0, r = e.length; a < r; a++) {
                    if (e[a] == t) return a;
                    s++
                }
                return -1
            },
            _getProducts: function(t) {
                var e = this;
                e.mobileFilter("loading-start");
                let s = appInit.APIs.api;
                return axios.jsonp(s, {
                    timeout: appInit.APIs.timeout,
                    name: "Cool",
                    callback: "callback",
                    cache: !0,
                    params: {
                        country: appInit.APIs.country,
                        gpns: t + ""
                    }
                }).then(function(t) {
                    t.products.length > 0 && (e.allProducts = t.products, e.mobileFilter("loading-end"))
                }).catch(function(t) {
                    e.mobileFilter("loading-end")
                })
            }
        },
        filters: {
            handHashTags(t) {
                var e = _.find(this.hashTagtext, {
                    keys: t
                });
                if (e) return e.title
            }
        },
        computed: {
            filterItems: function() {
                return this.filterBy(this.products, this.inputsStep1, "tags")
            },
            FILTERITEMS: function() {
                var t = this.products.filter(({
                    tags: t
                }) => this.FILTERS_TAGS.every(e => t.includes(e)));
                return this.FILTERSTAGSNU = t.length, this.FILTERS_ITEMS = t, t
            },
            gethashTagIcon(t) {
                return this.hashTagIcon[t]
            },
            referrers: function() {
                let t = document.referrer ? document.referrer : "../";
                return t
            },
            thisUrl: function() {
                return window.location.href
            }
        },
        watch: {},
        updated: function() {
            this.$nextTick(function() {
                if (window.location.hash) {
                    let t = document.querySelector(window.location.hash);
                    t && t.scrollIntoView({
                        behavior: "smooth",
                        block: "center"
                    })
                }
            })
        }
    });
jQuery(function() {
    var t = 0,
        e = jQuery("#products__container"),
        s = jQuery("#compare__button, #compare__close"),
        a = jQuery("#compare__fixed"),
        r = jQuery(".app__products___item"),
        n = jQuery("#compare_list").children("ul"),
        o = jQuery(".seo_title")[0],
        l = 3,
        c = 0,
        h = jQuery("#compare__cta");
    r.length;
    var d = jQuery("#restart"),
        p = navigator.userAgent,
        u = {
            iphone: p.match(/(iPhone|iPod)/),
            blackberry: p.match(/BlackBerry/),
            android: p.match(/Android/),
            windowsphone: p.match(/Windows Phone|Windows Mobile|IEMobile|MeeGo/)
        };

    function m() {
        t = 0, c = 0, jQuery(".app__products___item").each(function() {
            jQuery(this).removeClass("app__products__item_selected"), jQuery(this).removeClass("products_item_selected")
        }), jQuery(".app__compare__list__item").remove()
    }

    function f() {
        jQuery(".app__compare__list__item").length > l - 1 ? jQuery(".app__products___item").not(".app__products__item_selected").css({
            cursor: "not-allowed"
        }).addClass("no-before") : jQuery(".app__products___item").css({
            cursor: "pointer"
        }).removeClass("no-before"), c < 2 ? h.addClass("no-cl") : h.removeClass("no-cl")
    }

    function g(t) {
        jQuery(".app__products___item").each(function() {
            if (t) {
                var e = jQuery(this).attr("data-product-id");
                ("0" == e || "" == e) && jQuery(this).hide()
            } else jQuery(this).show()
        })
    }
    l = u.android || u.iphone || u.windowsphone ? 2 : 3, m(), s.click(function() {
        return 0 == t ? (t = 1, o.scrollIntoView({
            behavior: "smooth"
        }), jQuery("#restart").hide(), e.addClass("app__compare-active"), a.addClass("app__compare-active"), f()) : (t = 0, jQuery("#restart").show(), e.removeClass("app__compare-active"), a.removeClass("app__compare-active"), jQuery(".app__products___item").removeAttr("style")), !1
    }), jQuery(document).on("click", ".app__products___item", function(s) {
        var a = jQuery(this),
            r = a.attr("data-id"),
            o = a.attr("data-product-id");
        if (e.hasClass("app__compare-active")) {
            if (jQuery(".app__compare__list__item").each(function() {
                    if (r == jQuery(this).attr("data-id")) {
                        jQuery(this).remove(), c--;
                        return
                    }
                }), jQuery(".app__compare__list__item").length < l) {
                if (a.hasClass("app__products__item_selected")) a.removeClass("app__products__item_selected"), a.removeClass("products_item_selected");
                else {
                    a.addClass("app__products__item_selected"), a.addClass("products_item_selected");
                    var h = a.find("h2").html(),
                        d = a.find(".pic").html();
                    n.append('<li class="app__compare__list__item js__app__compare__remove" data-id="' + r + '" data-product-id="' + o + '"><div class="app__compare__list__item__content">' + d + '<span class="app__compare__list__item__text">' + h + '</span></div><button class="app__compare__remove js__app__compare__remove">\xd7</button></li>'), n.find(".app__product__image").removeClass("app__product__image").addClass("app__compare__list__item__image"), c++
                }
            }
            f()
        }
        return 1 != t
    }), jQuery(document).on("click", ".app__compare__remove", function() {
        var t = jQuery(this),
            e = t.parents(".app__compare__list__item").attr("data-id");
        jQuery(".app__products___item").each(function() {
            if (e == jQuery(this).attr("data-id")) {
                jQuery(this).removeClass("app__products__item_selected"), jQuery(this).removeClass("products_item_selected"), c--;
                return
            }
        }), t.parents(".app__compare__list__item").remove(), f()
    }), d.click(function() {
        m()
    }), h.click(function() {
        if (c < 2) return !1;
        var t = appInit.APIs.compare.host,
            e = u.android || u.iphone || u.windowsphone ? t + appInit.APIs.compare.urlMb : t + appInit.APIs.compare.url,
            s = [],
            a = appInit.APIs.compare.category,
            r = appInit.APIs.compare.subCategory,
            n = appInit.APIs.compare.locale,
            o = a ? a + "/" : "",
            l = r ? r + "/" : "";
        if (jQuery(".app__compare__list__item").each(function() {
                s.push(jQuery(this).attr("data-product-id"))
            }), o && l && (n ? n + "/" : "") && s.length > 0) {
            var s = s.length > 0 ? s.join("/") : "";
            e += o + l + s + "/"
        }
        jQuery("#compare__cta").attr("href", e)
    })
});